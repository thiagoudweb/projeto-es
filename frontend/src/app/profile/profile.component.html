<div class="page-wrapper">
  <div class="container">
    <!-- Botão de voltar -->
    <a routerLink="/home" class="back-button">
      <span class="back-arrow">←</span>
      Voltar
    </a>

    <!-- Loading State -->
    <div *ngIf="loading" class="loading">
      <div class="spinner"></div>
      Carregando perfil...
    </div>

    <!-- Error State -->
    <div *ngIf="error" class="error">
      <p>Erro ao carregar o perfil. Tente novamente.</p>
      <button class="btn btn-primary" (click)="loadProfile()">Tentar novamente</button>
    </div>

    <!-- Profile Content -->
    <div *ngIf="!loading && !error && profileData" id="profileContent">
      <div class="header">
        <div class="profile-avatar">{{ getInitials() }}</div>
        <div class="profile-name">{{ profileData.data?.fullName || 'Nome não disponível' }}</div>
        <button class="edit-button" (click)="editProfile()">Editar</button>
      </div>

      <div class="content">
        <!-- View Mode -->
        <div *ngIf="!showEditModal" class="view-mode">
          <!-- Layout para MENTOR -->
          <div *ngIf="profileData.type === 'MENTOR'" class="info-grid">
            <div class="info-item">
              <label class="info-label">Nome Completo</label>
              <div class="info-value">{{ profileData.data?.fullName || 'Não informado' }}</div>
            </div>

            <div class="info-item">
              <label class="info-label">Curso</label>
              <div class="info-value">{{ getCourseName(profileData.data?.course) }}</div>
            </div>

            <div class="info-item">
              <label class="info-label">Tipo de Vínculo</label>
              <div class="info-value">{{ getAffiliationTypeName(profileData.data?.affiliationType) }}</div>
            </div>

            <div class="info-item full-width">
              <label class="info-label">Resumo Profissional</label>
              <div class="info-value bio">{{ profileData.data?.professionalSummary || 'Não informado' }}</div>
            </div>

            <div class="info-item full-width">
              <label class="info-label">Especializações</label>
              <div class="specializations-container">
                <div *ngFor="let spec of getSpecializations()" class="specialization-item">
                  {{ spec }}
                </div>
                <div *ngIf="getSpecializations().length === 0" class="info-value">
                  Não informado
                </div>
              </div>
            </div>

            <!-- ÁREAS DE INTERESSE COM O MESMO ESTILO DAS ESPECIALIZAÇÕES -->
            <div class="info-item full-width">
              <label class="info-label">Áreas de Interesse</label>
              <div class="specializations-container">
                <div *ngFor="let area of getInterestAreas()" class="specialization-item">
                  {{ area }}
                </div>
                <div *ngIf="getInterestAreas().length === 0" class="info-value">
                  Não informado
                </div>
              </div>
            </div>

            <!-- Componente de busca para MENTOR -->
            <div class="info-item full-width">
              <label class="info-label">Buscar Mentorados</label>
              <app-mentor-search></app-mentor-search>
            </div>
          </div>

          <!-- Layout para MENTORADO -->
          <div *ngIf="profileData.type === 'MENTORADO'" class="info-grid">
            <div class="info-item">
              <label class="info-label">Nome Completo</label>
              <div class="info-value">{{ profileData.data?.fullName || 'Não informado' }}</div>
            </div>

            <div class="info-item">
              <label class="info-label">Curso</label>
              <div class="info-value">{{ getCourseName(profileData.data?.course) }}</div>
            </div>

            <div class="info-item full-width">
              <label class="info-label">Resumo Acadêmico</label>
              <div class="info-value bio">{{ profileData.data?.academicSummary || 'Não informado' }}</div>
            </div>

            <div class="info-item full-width">
              <label class="info-label">Áreas de Interesse</label>
              <div class="specializations-container">
                <div *ngFor="let area of getInterestAreas()" class="specialization-item">
                  {{ area }}
                </div>
                <div *ngIf="getInterestAreas().length === 0" class="info-value">
                  Não informado
                </div>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Botão de excluir fixo no canto inferior direito -->
  <button *ngIf="!loading && !error && profileData" class="delete-button" (click)="openDeleteModal()">
    <span class="delete-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trash-icon lucide-trash"><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"/><path d="M3 6h18"/><path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg></span>
    Excluir Perfil
  </button>

  <!-- Modais -->
  <app-edit-mentor-profile-modal
    *ngIf="showEditModal && profileData?.type === 'MENTOR'"
    [mentor]="profileData?.data || {}"
    (close)="closeEditModal()"
    (save)="saveMentorProfile($event)">
  </app-edit-mentor-profile-modal>

  <app-edit-mentored-modal
    *ngIf="showEditModal && profileData?.type === 'MENTORADO'"
    [mentored]="profileData?.data || {}"
    (close)="closeEditModal()"
    (save)="saveMentoredProfile($event)">
  </app-edit-mentored-modal>

  <app-delete-mentor-modal
    *ngIf="showDeleteModal && profileData?.type === 'MENTOR'"
    [mentor]="profileData?.data || {}"
    (cancelDelete)="cancelDelete()"
    (confirmDelete)="confirmDelete()">
  </app-delete-mentor-modal>

  <app-delete-mentored-modal
    *ngIf="showDeleteModal && profileData?.type === 'MENTORADO'"
    [mentored]="profileData?.data || {}"
    (cancelDelete)="cancelDelete()"
    (confirmDelete)="confirmDelete()">
  </app-delete-mentored-modal>
</div>
